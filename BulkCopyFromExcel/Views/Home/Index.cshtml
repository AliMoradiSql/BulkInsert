@{
    ViewData["Title"] = "Home page Test";
}

@*<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.10.4/jquery.ui.widget.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-file-upload/4.0.11/jquery.uploadfile.min.js"></script>

    <link href="https://cdnjs.cloudflare.com/ajax/libs/jquery-file-upload/4.0.11/uploadfile.min.css" rel="stylesheet" />
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <div class="card pt-5">
        <p class="h6">Mvc Home</p>
        <div class="card-header">
            <p>Enter Your File</p>
        </div>
        <div class="card-body">
            <form name="InformationsForm" role="form" novalidate class="needs-validation">

                <div class="row">
                    <div id="Info" class="col-md-12 mt-5 float-end">
                        <div class="form-group">
                            <label for="avatar">Choose a Excel File:</label>
                            <label class="btn btn-primary col-md-2">
                                <i class="fa fa-file"></i>
                                <span>Select / ChangeFile</span>
                                The file input field used as target for the file upload widget
                                <input id="fileupload" type="file" name="fileupload" maxlength="4000000" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" style="display:none" />
                            </label>
                        </div>
                    </div>
                    <button id="SubmitBtn" class="btn btn-success">Submit</button>
                </div>
            </form>
        </div>
        <div class="card-footer">


            <div class="footer bg-white py-4 d-flex flex-lg-column " id="kt_footer">
                <div class="d-flex flex-column flex-md-row align-items-center justify-content-between">
                    <div class="text-dark order-2 order-md-1">
                        <div class="text-muted font-weight-bold mr-2 h6">
                            BulkCopy Standard | v11.0.0 @DateTime.UtcNow
                        </div>
                        <div class="nav nav-dark order-1 order-md-2">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>*@
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.10.4/jquery.ui.widget.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-file-upload/4.0.11/jquery.uploadfile.min.js"></script>

    <link href="https://cdnjs.cloudflare.com/ajax/libs/jquery-file-upload/4.0.11/uploadfile.min.css" rel="stylesheet" />
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <style>
        body, h1 {
            font-family: "Raleway", Arial, sans-serif
        }

        h1 {
            letter-spacing: 6px
        }

        .w3-row-padding img {
            margin-bottom: 12px
        }
    </style>
</head>
<body>

    <!-- !PAGE CONTENT! -->
    <div class="w3-content" style="max-width:1500px">

        <!-- Header -->
        <header class="w3-panel w3-center w3-opacity" style="padding:12px 16px">
            <h1 class="w3-xlarge">Bulk Copy</h1>
        </header>
        <form asp-controller="Home" asp-action="Index" method="post" name="InformationsForm" role="form" enctype="multipart/form-data">

            <div class="row w3-center">
                <div id="Info" class="col-md-12 mt-5 ">
                    <div class="form-group">
                        <label class="btn btn-primary col-md-2">
                            <i class="fa fa-file"></i>
                            <span>Select / ChangeFile</span>
                            @*The file input field used as target for the file upload widget*@
                            <input id="fileupload" type="file" name="fileupload" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" style="display:none" />
                        </label>
                    </div>
                </div>
                <div class="col-md-12 float-end">
                    <button id="SubmitBtn" type="submit" class="btn btn-success" value="upload">Submit</button>
                </div>
            </div>
        </form>


        @*<div class="w3-padding-32">
                <div class="w3-bar w3-border">
                    <a href="#" class="w3-bar-item w3-button">Home</a>
                    <a href="#" class="w3-bar-item w3-button w3-light-grey">Portfolio</a>
                    <a href="#" class="w3-bar-item w3-button">Contact</a>
                    <a href="#" class="w3-bar-item w3-button w3-hide-small">Weddings</a>
                </div>
            </div>*@


        <!-- Photo Grid -->
        <!-- End Page Content -->
    </div>

    <!-- Footer -->
    <footer class="w3-container w3-padding-64 w3-light-grey w3-center w3-large">
        <i class="fa fa-facebook-official w3-hover-opacity"></i>
        <i class="fa fa-instagram w3-hover-opacity"></i>
        <i class="fa fa-snapchat w3-hover-opacity"></i>
        <i class="fa fa-pinterest-p w3-hover-opacity"></i>
        <i class="fa fa-twitter w3-hover-opacity"></i>
        <i class="fa fa-linkedin w3-hover-opacity"></i>
    </footer>


</body>
@*<script>
    $(document).ready(function () {
        var input = null;
        var files = null;
        var formData = new FormData();
        $("#SubmitBtn").click(function (event) {
            event.preventDefault();
            input = document.getElementById('fileupload');
            files = input.files[0];
            formData.append('files', files);
            console.log(formData);
            console.log(files);
            if (files == null || files == undefined) {
                alert("No File Selected!!");
            }
            if (formData.append.length < 1) {
                alert("Somthing Goes Wrong!!");
            }
            else {
                $.ajax(
                    {
                        url: "Home/BulkInsert",
                        data: formData,
                        processData: false,
                        contentType: false,
                        type: "POST",
                        success: function (data) {
                            alert("Files Uploaded!");
                        },
                        error: function (err) {
                            console.log(err);
                            alert('Failed');

                        }
                    }
                ).done(function () {
                    alert("Done!");
                    $("#fileupload").val(null);
                });
            }
        });
    });
</script>*@
